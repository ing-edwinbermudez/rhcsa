# Lab: Shell Scripting and the Command Line

✅ **Task 1:**

Create the executable /home/student/bin/bash-lab.sh script file on the workstation machine. Add a #! directive to execute under the /bin/bash interpreter. The script must be empty besides the #! directive.

```bash
ls -l /home/student/bin 2>/dev/null 2>&1
if [[ $? != 0 ]]; then
    mkdir /home/student/bin
else
    echo "################################################################################################"
    echo "The bin directory was created, and it contains the following files: $(ls -l /home/student/bin)"
fi
cat << EOF > /home/student/bin/bash-lab.sh
#!/usr/bin/bash
EOF
chmod +x /home/student/bin/bash-lab.sh
```

✅ **Task 2:**

Edit your newly created script file to store the following information from the `servera` and `serverb` machines on the workstation machine. Store the output of the listed commands from the following table in the `/home/student/output-servera` and `/home/student/output-serverb` files respectively on the workstation machine. Print a sequence of hash signs (#) to differentiate the output of the successive commands in the output file.

| Command              | Notes                                              |
| -------------------- | -------------------------------------------------- |
| `hostname --fqdn`    | Store the entire output.                           |
| `echo "#####"`       | Append the hash signs to differentiate the following command. |
| `hostname --ip-address` | Store the entire output.                        |
| `echo "#####"`       | Append the hash signs to differentiate the following command. |
| `uname --machine`    | Store the entire output.                           |

Save the required information to the `output-servera` and `output-serverb` files in the `/home/student` directory on workstation.

Note
    
    Remember to use a loop to simplify your script. You can use shell variables to store the output file name and SSH destination.

```bash
vim /home/student/bin/bash-lab.sh
```

```bash
#!/usr/bin/bash

: | tee /home/student/output-servera /home/student/output-serverb >/dev/null

for host in server{a,b}; do
    for cmd in "hostname --fqdn" "hostname --ip-address" "uname --machine"; do
        if [[ "${host}" == "servera" ]]; then
            ssh student@${host} $cmd >> /home/student/output-servera
            echo "#####" >> /home/student/output-servera
        else
            ssh student@${host} $cmd >> /home/student/output-serverb
            echo "#####" >> /home/student/output-serverb
        fi
    done
done
```

```bash
#!/usr/bin/bash

USER='student'
PREFIX='/home/student/output'

for SERVER in servera serverb; do
  OUTPUT=${PREFIX}-${SERVER}
  DESTINATION=${USER}@${SERVER}

  ssh ${DESTINATION} "hostname --fqdn" > ${OUTPUT}
  echo "#####" >> ${OUTPUT}
  ssh ${DESTINATION} "hostname --ip-address" >> ${OUTPUT}
  echo "#####" >> ${OUTPUT}
  ssh ${DESTINATION} "uname --machine" >> ${OUTPUT}
done
```

✅ **Task 3:**

Execute the `/home/student/bin/bash-lab.sh` script and review the output content on the workstation machine. The `/home/student/bin` directory is already included in the student user's PATH environment variable.

```bash
echo $PATH
export PATH=${PATH}:/home/student/bin
echo $PATH

/home/student/bin/bash-lab.sh
cat /home/student/output-servera
cat /home/student/output-serverb
```
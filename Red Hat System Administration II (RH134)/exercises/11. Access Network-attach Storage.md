# Lab: Access Network-attached Storage
---

✅ **Task 1:**

On the `servera` machine, install the `autofs` package.

```bash
ssh student@servera
sudo -i
dnf install autofs -y
```

✅ **Task 2:**

On the `servera` machine, manually mount the `serverb:/shares` NFS export on the `/mnt` directory. This task helps you verify that exports are configured with the correct access and permissions. Unmount the `/mnt` directory.

```bash
mount -t nfs serverb:/shares /mnt
# mount -t nfs -o rw,sync serverb:/shares /mnt
ls -l /mnt
umount /mnt
```

✅ **Task 3:**

On the `servera` machine, create an automounter indirect map to mount NFS exports along with all the subdirectories in the `/remote` directory.

Use the `/etc/auto.master.d/shares.autofs` file for the master map and the `/etc/auto.shares` file for the mapping file. Synchronously mount the `serverb:/shares/&` NFS export in the read/write mode.

Start the autofs service and configure it to start automatically.

```bash
echo "/remote /etc/auto.shares" >> /etc/auto.master.d/shares.autofs
cat /etc/auto.master.d/shares.autofs

echo "* -rw,sync,fstype=nfs4 serverb:/shares/&" >> /etc/auto.shares
cat /etc/auto.shares

systemctl enable --now autofs
mount | grep nfs
```


✅ **Task 4:**

As the `manager1` user on the `servera` machine, verify that you can access the `/remote/management` directory.

List the contents of the `/remote/management` directory and view the content of the `/remote/management/Welcome.txt` file. Then, create the `/remote/management/test.txt` file with TEST as the text.

Return as the `root` user on the servera machine.


```bash
su - db1
ls -l /remote/management
df -h 
cat /remote/management/Welcome.txt
echo "TEST1" >> /remote/management/test.txt
cat /remote/management/test.txt
exit
```

✅ **Task 5:**

As the `dbuser1` user on the servera machine, verify that you can access the `/remote/production` directory.

List the contents of the `/remote/production` directory and view the content of the `/remote/production/Welcome.txt` file. Then, create the `/remote/production/test.txt` file with `TEST2` as the text.

Return as the root user on the servera machine.

```bash
su - dbuser1
df -h
ls -l /remote/production
cat /remote/production/Welcome.txt
echo TEST2  >> /remote/production/test.txt
cat /remote/production/test.txt
exit
```

✅ **Task 6:**

As the `contractor1` user on the `servera` machine, verify that you can access the `/remote/operation` directory.

List the contents of the `/remote/operation` directory and view the content of the `/remote/operation/Welcome.txt` file. Then, create the `/remote/operation/test.txt` file with `TEST3` as the text.

Return as the `root` user on the `servera` machine.


```bash
su - contractor1
ls -l /remote/operation
cat /remote/operation/Welcome.txt
echo TEST3 >>/remote/operation/test.txt
cat /remote/operation/test.txt
exit
```

✅ **Task 7:**

Verify that the NFS exports are now mounted because you accessed the exported directories.

```bash
mount |grep serverb
mount |grep nfs
```
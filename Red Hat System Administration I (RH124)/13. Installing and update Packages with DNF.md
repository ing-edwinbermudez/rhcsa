# Installing and Updating Packages with DNF

## Managing Software Packages with DNF

Starting with Red Hat Enterprise Linux 9, DNF (Dandified YUM) replaces YUM as the package manager. DNF commands are functionally the same as YUM commands. For compatibility, YUM commands still exist as symbolic links to DNF:

```bash
ls -l /bin/ | grep yum | awk '{print $9 " " $10 " " $11}'
```

```bash
yum -> dnf-3
yum-builddep -> ../libexec/dnf-utils
yum-config-manager -> ../libexec/dnf-utils
yumdownloader -> ../libexec/dnf-utils
yum-groups-manager -> ../libexec/dnf-utils
```
The low-level rpm command can be used to install packages, but it is not designed to work with package repositories or to resolve dependencies from multiple sources automatically

DNF improves RPM-based software installation and updates. With the `dnf` command, you can install, update, remove, and get information about software packages and their dependencies. You can get a history of transactions and work with multiple Red Hat and third-party software repositories.

## The BaseOS and Application Stream Repositories

Red Hat Enterprise Linux 10 distributes content through two main software repositories: `BaseOS` and `Application Stream (AppStream)`. Both BaseOS and AppStream are necessary parts of a Red Hat Enterprise Linux 10 system.

The `BaseOS` repository provides the core operating system content for Red Hat Enterprise Linux as RPM packages. BaseOS components have the same lifecycle as content in previous Red Hat Enterprise Linux releases.

`Application Stream` contains necessary parts of the system, as well as a wide range of applications that were previously available as part of Red Hat Software Collections and other products and programs. Each Application Stream has a lifecycle that is either the same as Red Hat Enterprise Linux 10 or shorter.

## Finding Software with DNF

The `dnf help` command displays usage information. The `dnf list` command displays installed and available packages.

The following example uses a wildcard character to list the installed and available packages that start with the http keyword.

```bash
dnf list http*
```

The `dnf search KEYWORD` command lists packages by keywords that are in the name and summary fields only. To search for packages with "web server" in their name, summary, and description fields, use search all with the web server keyword:

```bash
dnf search all 'web server'
```

The `dnf info PACKAGENAME` command returns detailed information about a package, including the needed disk space for installation. For example, the following command retrieves information about the httpd package:

```bash
dnf info httpd
```

The dnf provides PATHNAME command displays packages that match the specified path name (the path names often include wildcard characters). For example, the following command finds packages that provide the `/var/www/html` directory:

```bash
dnf provides /var/www/html
```

## Installing, Updating, and Removing Software with DNF

The dnf install PACKAGENAME command obtains and installs a software package, including any dependencies.

```bash
sudo dnf install httpd
```

The dnf update PACKAGENAME command obtains and installs a later version of the specified package, including any dependencies. Generally, the process tries to preserve configuration files in place, but in some cases, those files might be renamed if the packager considers that the previous file name will not work after the update. If no package name is specified, then the command installs all relevant updates.

```bash
sudo dnf update
```

Because a new kernel can be tested only by booting to that kernel, the package specifically supports the installation of multiple versions at the same time. If the new kernel fails to boot, then the earlier kernel is still available. Running the `dnf update kernel` command installs the new kernel. The configuration files hold a list of packages to always install even if the administrator requests an update.

Use the `dnf list kernel` command to list all installed and available kernels. To view the currently running kernel, use the `uname` command. The uname command `-r` option shows only the kernel version and release, and the `uname` command `-a` option shows the kernel release and additional information.

```bash
dnf list kernel
uname -r
uname -a
```

The dnf remove PACKAGENAME command removes an installed software package, including any supported packages.

```bash
sudo dnf remove httpd
```
**Warning**
The dnf remove command removes the listed packages and any package that requires those packages (and packages which require those packages, and so on). This command can lead to unexpected removal of packages, so carefully review the list of packages to be removed.

## Installing and Removing Groups of Software with DNF

With DNF, you can also install and remove groups, which are collections of related software that are installed together.

In Red Hat Enterprise Linux, the `dnf` command can install two kinds of package groups. Regular groups are collections of packages. Environment groups are collections of regular groups. The packages or groups that these collections provide might be listed as mandatory (they must be installed if the group is installed), default (typically installed if the group is installed), or optional (not installed when the group is installed, unless specifically requested).

Similar to the `dnf list` command, the `dnf group list` command shows the names of installed and available groups.

```bash
dnf group info 'Security Tools'
``` 

The dnf group install command installs a group that installs its mandatory and default packages and their dependent packages.

```bash 
sudo dnf group install 'System Tools'
```

## Viewing Transaction History

All installation and removal transactions are logged in the `/var/log/dnf.rpm.log` file.

```bash
tail -5 /var/log/dnf.rpm.log
```

The `dnf history` command displays a summary of installation and removal transactions.

```bash
dnf history
dnf history info 9
```

#### Summary of DNF Commands

Packages can be located, installed, updated, and removed by name or by package groups.

| Command | Task |
|---------|------|
| `dnf list [NAME-PATTERN]` | List installed and available packages by name. |
| `dnf group list` | List installed and available groups. |
| `dnf search KEYWORD` | Search for a package by keyword. |
| `dnf info PACKAGENAME` | Show details of a package. |
| `dnf install PACKAGENAME` | Install a package. |
| `dnf group install GROUPNAME` | Install a package group. |
| `dnf update` | Update all packages. |
| `dnf remove PACKAGENAME` | Remove a package. |
| `dnf history` | Display transaction history. |


# Enabling DNF Software Repositories

## Managing Software Repositories

By default, RHEL systems include configuration to access Red Hat repositories. In many situations, you must configure additional repositories to access software from your organization or from a third party. For example, Adobe provides some of its software for Linux through DNF repositories. In the Red Hat classroom provided for this content, the content.example.com server hosts DNF repositories. The dnf command can access repositories from a website, an FTP server, or the local file system.

You might also need to enable or disable repositories to avoid conflicts when installing packages from different sources. You can manage the system repositories by manually updating the repository files, or by using DNF. The `dnf repolist all` command lists all available repositories and their statuses:

```bash
dnf repolist all
```

The `dnf config-manager` command can enable and disable repositories. For example, the following command enables the rhel-10-for-x86_64-baseos-debug-rpms repository:

```bash
dnf config-manager --enable rhel-10-for-x86_64-baseos-debug-rpms
```

## Configuring DNF Repositories

You can configure Red Hat and third-party repositories by manually updating a repository file, or by using the command line.

### Manual Configuration

To manually configure a DNF repository, you can either create a .repo file in the `/etc/yum.repos.d/` directory, or you can add a [repository] section to the `/etc/dnf/dnf.conf` file. Red Hat recommends using .repo files, and reserving the dnf.conf file for additional repository configurations. The dnf command searches both locations by default; however, the `.repo` files take precedence. A `.repo` file contains the URL of the repository, a name, and whether to use GPG keys to verify the package signatures. If GPG keys are required, then the .repo file also includes the URL to point to the trusted GPG key.

```bash
dnf config-manager \
--add-repo="https://https://dl.fedoraproject.org/pub/epel/10/Everything/x86_64/"
```
The corresponding `.repo` file is visible in the `/etc/yum.repos.d/` directory:

```bash
cd /etc/yum.repos.d
cat \
dl.fedoraproject.org_pub_epel_10_Everything_x86_64_.repo
```

### Verifying Signed Packages

The rpm command uses GPG keys to sign packages, and imports public keys to verify the integrity and authenticity of packages. The dnf command uses repository configuration files to provide the GPG public key locations, and imports the keys to verify the packages

Keys are stored in various locations on the remote repository site, such as `https://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-10`. Administrators should download the key to a local file rather than use the dnf command to retrieve the key from an external source.

For example, the following `.repo` file uses the gpgkey parameter to reference a local key:

```bash
[EPEL]
name=EPEL 10
baseurl=https://dl.fedoraproject.org/pub/epel/10/Everything/x86_64/
enabled=1
gpgcheck=1
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-10
```

### Configuring Repositories by Using RPM Packages

To simplify installation, some repositories provide a configuration file and a GPG public key as part of an RPM package. You can import the GPG public key by using the `rpm --import` command. The `dnf install` command can download and install these RPM packages.

For example, the following example imports the RPM-GPG-KEY-EPEL-10 (EPEL) GPG public key and installs the RHEL 10 Extra Packages for Enterprise Linux (EPEL) repository RPM:

```bash
rpm --import \
https://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-10

dnf install \
https://dl.fedoraproject.org/pub/epel/epel-release-latest-10.noarch.rpm
```

**Warning**
Import the RPM GPG key before installing signed packages, to ensure that packages come from a trusted source. If the RPM GPG key is not imported, then the `dnf` command fails to install signed packages.

The dnf command `--nogpgcheck` option ignores missing GPG keys, but might result in installing compromised or forged packages.

The `.repo` files often list multiple repository references in a single file. Each repository reference begins with a single-word name in square brackets.

```bash
cat /etc/yum.repos.d/epel.repo
```

To define a repository, but not to search it by default, insert the `enabled=0` parameter. Although the dnf config-manager command persistently enables and disables repositories, the `dnf` command `--enablerepo=PATTERN` and `--disablerepo=PATTERN` options enable and disable repositories temporarily while the command runs.